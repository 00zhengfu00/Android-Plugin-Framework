# Android-Plugin-Framework


此项目是Android插件框架完整源码以及实例。用来开发Android插件APK，并通过动态加载的方式在宿主程序中运行。

若插件APK是完全独立的APK，那么插件apk也可独立安装运行。
若插件APK不是完全独立的apk，比如和插件宿主程序共用一些依赖库，那么插件apk只能在宿主程序中运行。不可独立运行。
因为此时插件apk的代码是不完整的。

目录结构说明：

  PluginCore工程是插件库核心工程。用于提供对插件功能的支持。

  PluginMain是用来测试的插件宿主程序Demo工程。

  PluginShareLib是用来测试的插件宿主程序的依赖库Demo工程

  PluginTest是用来测试的插件Demo工程。此工程下有用来编译插件的ant脚本。

宿主程序工程可以通过ant编译或者导入eclipse后直接点击Run菜单进行安装。

插件Demo工程需要通过插件ant脚本编译。原因是Demo中引用了宿主程序的依赖库。需要在编译时对共享库进行排除。


已支持的功能：
  1、插件apk无需安装，由宿主程序动态加载运行。
  2、插件形式支持fragment和activity代理。
     这两种形式是插件开发总的两种主要形式。
  3、插件库apk可无任何特殊代码。如插件中的fragment，activity等无需继承任何特定基类或接口。完全和普通app代码没有区别.
  4、支持插件共用宿主程序依赖库提供的自定义控件，
  5、支持插件中使用自定义控件
  6、支持插件资源和宿主资源混合使用。意即支持如下场景:
     插件程序和宿主程序共用依赖库时插件中的布局文件中使用了宿主程序中的自定义控件，而宿主程序中的自定义控件中又使用
     了宿主程序中的布局文件。
     插件代码中无需做任何特殊处理，即可支持这种布局文件。
  7、插件中的各种资源、布局、R、以及宿主程序中的各种资源、布局、R等可随意使用、也无任何特殊代码。
  8、支持插件使用宿主程序主题和系统主题
  9、解决资源id冲突问题。尝试做过插件开发的同学应该都遇到，插件资源id和宿主程序资源id可能相同，导致获取的资源不是想要的资源。
     此问题其实在android提供的编译器aapt中早已提供了支持。
     
暂不支持的功能：
  1、暂不支持使用插件中自定义主题，
  2、支持在插件中通过R文件使用宿主程序中的资源，暂不支持插件资源文件中直接使用宿主程序中的资源。但是支持间接使用。
     例如在上述“已支持的功能”6中描述的,实际就是间接使用。
  
后续需要解决的问题：
  1、使支持插件自定义主题
  2、使支持插件资源文件中直接引用依赖库中的资源。目测可能需要重写android自带的aapt程序。
  
